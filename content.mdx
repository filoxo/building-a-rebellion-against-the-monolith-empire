import RebelAlliance from './img/rebel_alliance.svg';

<div className="w-screen h-screen flex items-center justify-center text-white bg-black">
<h1 className="text-5xl" style={{ transform: "perspective(400px) rotateX(40deg)" }}>
<span>Building a Rebellion against</span>
<RebelAlliance
  width="7rem"
  height="7rem"
  className="mx-auto"
  aria-hidden="true"
/>
<span>the Monolith Empire</span>
</h1>
</div>

---

# What are **microfrontends**?

---

import Tweet from './img/twitter.com_markdalgleish_status_1150488911744917505.png'

<div className="w-screen h-screen flex items-center justify-center text-white bg-black">

<img src={Tweet} alt="A tweet from @markdalgleish that reads, 'Back end devs: Front end isn't real engineering. Front end devs: *Bring engineering principles to front end* Backend devs: Front end is too complicated.' shared on Jul 14, 2019." className="rounded-md border-2 border-gray-600" />

</div>

---

<p className="text-center block text-xl">microfrontends are</p>

## Microservices patterns applied to frontend engineering

<div className="flex justify-center">

- loosely coupled services, highly cohesive code
- fosters team autonomy
- improves scalability

</div>

---

- loosely coupled → independent deployments
- highly cohesive → code maintainability
- fosters team autonomy → ownership
- scalable → speed (Agile)

---

# Benefits

1. Independent deployments
2. Migration
   - The 'Strangler Pattern'
3. Experimentation
4. Resilience

---

<p className="text-4xl text-center" style={{ color: 'rgb(0, 17, 255)' }}>
  single-spa
</p>

![single-spa logo](https://single-spa.js.org/img/logo-white-bgblue.svg){.mx-auto width="100"}

<p className="font-light">"A JavaScript router for frontend microservices"</p>

---

import ComponentModel from './img/component-model.png';

<!-- https://excalidraw.com/#json=6328682335436800,YBcbfxpnnD1zZpREervmMA -->

# Component model

<img
  src={ComponentModel}
  className="mx-auto"
  style={{ height: '50vh' }}
  alt="This diagram shows that React + ReactDOM have a render method to put an application on the page. react-router then uses the current URL to mount and unmount components conditionally. The objective is to highlight that render, mount, and unmount are lifecycles of the component model."
/>

---

import SingleSpaLifecyclesModel from './img/single-spa-lifecycles-model.png';

# single-spa Lifecycles

<img
  src={SingleSpaLifecyclesModel}
  className="mx-auto"
  style={{ height: '50vh' }}
  alt="This diagram shows single-spa lifecycles, based on the component model. single-spa is the top-level router and applications must implement bootstrap, mount, and unmount lifecycles. Then single-spa will bootstrap applications once, and then mount and unmount them based on the current route."
/>

---

import { InitialPageLayout } from './PageLayouts';

<p className="sr-only">
  So let's go back to a monolith. Have you ever worked on a codebase that had
  parts of it owned by others? For example, Team X owns the left nav. Due to
  politics, Team Y owns the Main section but not really because of external
  reasons. And lastly it is completely unclear who owns the Top Nav because
  everyone contributes to it but no one team is it's owner.
</p>

<InitialPageLayout />

---

import { AssignedPageLayout } from './PageLayouts';

<p className="sr-only">
  In a single-spa setup, you could have clear divisions of the applications; and
  therefore clear ownership of specific features in the codebase. These teams
  are enabled to be more autonomous. This image shows the same sections but
  assigned to Red Squad, Gold Squad, and Blue Squad.
</p>

<AssignedPageLayout />

---

import { ShipsPageLayout } from './PageLayouts';

<p className="sr-only">
  Autonomous teams enable independent code deployments. A team can decide how
  best to develop their feature. single-spa's lifecycles abstract the component
  model so you can use just about any modern framework to develop a
  microfrontend. For example Red Squad can choose an X-wing, the fastest ship
  available but doesn't have a large impact. Gold Squad can make use of a
  Y-wing, a fast ship that is good for everyday missions. And Blue Squad can use
  a B-wing, a slow ship that has a large impact.
</p>

<p className="sr-only">
  Additional shared modules and utilities (Millenium Falcon) can also be helpful
  in fighting the Empire by centralizing shared logic and standardizing on
  libraries so teams can move more quickly.
</p>

<ShipsPageLayout />

---

import SvelteSvg from './img/svelte.svg';

# Ecosystem

<div className="flex items-center justify-between">

<img
  alt="Reactjs"
  src="https://camo.githubusercontent.com/f81df8111223bbd67da1e3514bea41d5a63ff89a/68747470733a2f2f6564656e742e6769746875622e696f2f537570657254696e7949636f6e732f696d616765732f7376672f72656163742e737667"
  className="w-1/5"
/>

<img
  alt="Vuejs"
  src="https://camo.githubusercontent.com/e47ae34fd825cb4bbc9cd3320a4bfe6bf0899381/68747470733a2f2f6564656e742e6769746875622e696f2f537570657254696e7949636f6e732f696d616765732f7376672f7675652e737667"
  className="w-1/5"
/>

<img
  alt="Angular"
  src="https://camo.githubusercontent.com/37cba63c9b85334eba8e1cd06f140484792327b6/68747470733a2f2f6564656e742e6769746875622e696f2f537570657254696e7949636f6e732f696d616765732f7376672f616e67756c61722e737667"
  className="w-1/5"
/>

<div className="w-1/5 px-3">
  <SvelteSvg aria-label="Svelte" aria-role="image" />
</div>

</div>


<div className="flex justify-center">

- AngularJS
- Web Components
- Preact
- Alpinejs

</div>


[https://single-spa.js.org/docs/ecosystem](){.text-center .block}

---

import MillenniumFalcon from './img/millennium-falcon.svg'

<div className="flex">
<div className="w-1/2 inline-flex flex-col items-center justify-between">

  <p className="text-2xl text-center">Shared dependencies</p>


  <RebelAlliance
    color="dimgray"
    width="5rem"
    className=""
  />
  
  </div>
  <div className="w-1/2 inline-flex flex-col items-center justify-between">

  <p className="text-2xl text-center">Utility modules</p>

  <MillenniumFalcon
    color="dimgray"
    width="5rem"
    className=""
  />

</div>
</div>

---

<p className="text-center text-2xl mb-6"><span className="block text-3xl">Utility modules</span> are for sharing common logic</p>

- authentication/authorization
- data fetching
- styleguide/component library
- notifications service
- singleton libraries (eg. styled-components)


https://single-spa.js.org/docs/recommended-setup/#utility-modules-styleguide-api-etc

https://single-spa.js.org/docs/module-types/#utilities

---

<span className="text-2xl text-center">

`import React from 'react'`

</span>

<div className="w-1/2 mt-3 ml-auto mr-auto">

In a browser environment and no `node_modules` available, how to resolve what `'react'` is?

</div>

---

# SystemJS & import maps


> A module loader for all browsers supporting ES module semantics with the System module format.

<div className="text-center">

https://github.com/systemjs/systemjs

https://github.com/WICG/import-maps/

</div>

---

import DeathStarPlans from './img/deathstar-plans.gif';

<div className="w-screen h-screen flex items-center justify-center bg-black">
  <img
    src={DeathStarPlans}
    alt="Image showing rudimentary Death Star plans, analogous to understading your monolith before breaking it up."
  />
</div>

<p className="sr-only">
  Once you understand the monolith, you can begin plans to break it up into
  applications, utility modules, and shared dependencies. This architecture
  will also require changes to engineering culture and development workflows.
  All of those are tradeoffs to using microfrontends.
</p>

---

# single-spa Resources

- [Recommended Setup](https://single-spa.js.org/docs/recommended-setup/) - architecture overview
- [create-single-spa](https://single-spa.js.org/docs/create-single-spa/) - utility to generate starter code
- [github.com/single-spa/single-spa](https://github.com/single-spa/single-spa) - many active projects

---

# Additional Resources

- [micro-frontends.org](https://micro-frontends.org/)
- ["I don't understand micro-frontends" by Luca Mezzalira](https://medium.com/@lucamezzalira/i-dont-understand-micro-frontends-88f7304799a9)
- ["Developing and Deploying Micro-Frontends With Single-Spa" by Tyler Hawkins](https://medium.com/@thawkin3/developing-and-deploying-micro-frontends-with-single-spa-c8b49f2a1b1d)
- ["Bad Assumptions about Microfrontends" by Carlos Filoteo (myself)](https://filoxo.github.io/bad-assumptions-about-microfrontends/)
